package com.gamearcade.eventconsumer;

import java.util.Scanner;

import org.osgi.framework.BundleActivator;
import org.osgi.framework.BundleContext;
import org.osgi.framework.ServiceReference;

import com.gamearcade.eventpublisher.IEventPublisher;

public class EventConsumerActivator implements BundleActivator {
	
	@SuppressWarnings("rawtypes")
	ServiceReference eventPublisherServiceReference;

	public void start(BundleContext context) throws Exception {
		System.out.println("Event consumer started...\n");
		eventPublisherServiceReference = context.getServiceReference(IEventPublisher.class.getName());
		@SuppressWarnings("unchecked")
		IEventPublisher eventPublisher = (IEventPublisher) context.getService(eventPublisherServiceReference);
		
        @SuppressWarnings("resource")
		Scanner add = new Scanner(System.in);
        System.out.println("Are you a student, an admin, or an event consumer? (student/admin/eventConsumer): ");
        String consumerType = add.next().trim().toLowerCase();
        if (consumerType.equals("student") || consumerType.equals("admin") || consumerType.equals("eventconsumer")) {
            eventPublisher.selectOption(consumerType);
        } else {
            System.out.println("Invalid consumer type.");
        }
	}

	public void stop(BundleContext context) throws Exception {
		System.out.println("Event consumer stopped...\n");
		context.ungetService(eventPublisherServiceReference);
	}

}
